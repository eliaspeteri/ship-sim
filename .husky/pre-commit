#!/usr/bin/env sh

# Ensure hooks run on project-supported Node.
if [ -s "$HOME/.nvm/nvm.sh" ]; then
  . "$HOME/.nvm/nvm.sh"
  nvm use --silent >/dev/null 2>&1 || true
fi

NODE_MAJOR="$(node -p "process.versions.node.split('.')[0]")"
if [ "$NODE_MAJOR" -lt 20 ]; then
  echo "Pre-commit requires Node >=20. Run: nvm use"
  exit 1
fi

# Run eslint with ESM flat config support
export NODE_OPTIONS=--experimental-vm-modules
npm exec lint-staged
